-- Dropping existing tables
drop table if exists reviews cascade;
drop table if exists restaurants cascade;
drop table if exists users cascade;

-- Creating tables
create table restaurants (
                             price_range float(53),
                             id bigint generated by default as identity,
                             address varchar(255) not null,
                             contact_info varchar(255),
                             cuisine varchar(255),
                             menu varchar(255),
                             name varchar(255) not null,
                             opening_hours varchar(255),
                             primary key (id)
);

create table reviews (
                         rating integer not null,
                         id bigint generated by default as identity,
                         restaurant_id bigint not null,
                         user_id bigint not null,
                         text varchar(255),
                         primary key (id)
);

create table users (
                       is_admin boolean not null,
                       id bigint generated by default as identity,
                       email varchar(255) not null unique,
                       first_name varchar(255) not null,
                       last_name varchar(255) not null,
                       password varchar(255) not null,
                       primary key (id)
);

-- Adding foreign key constraints
alter table if exists reviews
    add constraint FKsu8ow2q842enesfbqphjrfi5g
    foreign key (restaurant_id) references restaurants;

-- Inserting sample data
INSERT INTO restaurants (price_range, address, contact_info, cuisine, menu, name, opening_hours) VALUES
    (2.0, '123 Main St, Springfield', '555-1234', 'Italian', 'menu1.pdf', 'Luigis', 'Mon-Sun 11:00-22:00'),
(1.0, '456 Elm St, Springfield', '555-5678', 'Fast Food', 'menu2.pdf', 'Burger Haven', 'Mon-Sun 10:00-23:00'),
(3.0, '789 Oak St, Springfield', '555-8765', 'Sushi', 'menu3.pdf', 'Sushi World', 'Mon-Sun 12:00-21:00');

INSERT INTO users (is_admin, email, first_name, last_name, password) VALUES
(false, 'john.doe@example.com', 'John', 'Doe', 'password123'),
(false, 'jane.smith@example.com', 'Jane', 'Smith', 'password456'),
(true, 'admin@example.com', 'Admin', 'User', 'adminpassword');

INSERT INTO reviews (rating, restaurant_id, user_id, text) VALUES
(5, 1, 1, 'Amazing food and great service!'),
(4, 2, 2, 'Good burgers but the fries were a bit salty.'),
(3, 3, 3, 'Sushi was fresh but the wait time was long.');
